#!/usr/bin/env python3

from config import config
from collection import DocumentCollection, TopicCollection
from index import InvertedIndex

def main():
    documents = DocumentCollection(config.documents_list)

    # Stopwords may need to go through all documents
    try:
        config.stopwords.initialize_from_data(documents)
    except AttributeError:
        pass

    index = InvertedIndex(documents)     

    topics = TopicCollection(config.topics_list)
    for topic in topics:
        query = topic.title
        result = index.retrieve(query)

        for rank, (docid, score) in enumerate(result):
            print(topic.num, 0, docid, rank, score, config.run_id, sep='\t', file=config.output_file)
        

if __name__ == '__main__':
    main()
